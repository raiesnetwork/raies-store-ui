import{r as B,u as F,c as H,a as I,d as L,j as n,B as l}from"./index-O9k_qbqq.js";import{H as R}from"./Header-DR75LYZ0.js";const Y=()=>{var y,b,v,_,j,N,x;const[r,P]=B.useState(Array(6).fill("")),{loginUser:k,createUser:w,setUserName:m}=F(s=>s),o=H(),{login:d}=I()||{},g=L(),p=((y=o.state)==null?void 0:y.mobileNumber)||"",f=((b=o.state)==null?void 0:b.subdomain)||"",E=((v=o.state)==null?void 0:v.registration)||!1,U=((_=o.state)==null?void 0:_.username)||"",S=((j=o.state)==null?void 0:j.password)||"",C=((N=o.state)==null?void 0:N.paymentType)||"",h=((x=o.state)==null?void 0:x.userType)||"",$=async()=>{var e,a,i,c,O,T;const s=r.join("");if(s.length===6&&p){let t;if(E)if(t=await w({fullName:U,mobileNumber:p,otp:s,hostname:f,password:S,userType:h,paymentType:C}),t.error)l.error(t.message||"User registration failed");else{l.success("User registered successfully!"),m((e=t.data)==null?void 0:e.username);const u={username:(a=t.data)==null?void 0:a.username,api_token:(i=t.data)==null?void 0:i.token};d(u),g("/home")}else if(t=await k(p,s,f,h),t.error)l.error(t.message||"OTP verification failed");else{m((c=t.data)==null?void 0:c.username);const u={username:(O=t.data)==null?void 0:O.username,api_token:(T=t.data)==null?void 0:T.token};d(u),l.success("OTP verified successfully!"),g("/home")}}else l.error("Please enter a valid 6-digit OTP.")},A=(s,e)=>{const a=s.target.value;if(/^[0-9]$/.test(a)||a===""){const i=[...r];if(i[e]=a,P(i),a&&e<r.length-1){const c=document.getElementById(`otp-input-${e+1}`);c&&c.focus()}}};return n.jsxs(n.Fragment,{children:[n.jsx(R,{}),n.jsxs("div",{className:"otp-page",children:[n.jsx("div",{className:"otp-page__header",children:"Enter OTP"}),n.jsx("div",{className:"otp-page__input-container",children:r.map((s,e)=>n.jsx("input",{type:"text",maxLength:1,value:r[e],onChange:a=>A(a,e),id:`otp-input-${e}`,className:"otp-page__input-box"},e||s))}),n.jsx("div",{className:"otp-page__btn-container",children:n.jsx("button",{className:"otp-page__btn",onClick:$,children:"VERIFY"})})]})]})};export{Y as default};
