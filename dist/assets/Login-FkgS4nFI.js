import{ag as O,ah as V,r,ai as w,aj as D,ak as ie,al as Y,j as e,am as k,an as z,g as fe,a as ve,u as _e,n as be,H as ye,L as je,ao as we}from"./index-DO3I4ds2.js";import{U as ee,c as se}from"./index-siBYNNm5.js";/* empty css              */import{B as Se,M as Ce,P as ne,u as Ne,a as Pe,F as De,T as ke,b as oe,S as te,c as P,d as ae,I as Me,e as We,V as Te,f as Re,C as re}from"./Login-CkgJ_diG.js";function Fe(o){return V("MuiDialog",o)}const K=O("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),le=r.createContext({}),$e=w(Se,{name:"MuiDialog",slot:"Backdrop",overrides:(o,s)=>s.backdrop})({zIndex:-1}),Ee=o=>{const{classes:s,scroll:t,maxWidth:n,fullWidth:l,fullScreen:d}=o,i={root:["root"],container:["container",`scroll${D(t)}`],paper:["paper",`paperScroll${D(t)}`,`paperWidth${D(String(n))}`,l&&"paperFullWidth",d&&"paperFullScreen"]};return z(i,Fe,s)},Ue=w(Ce,{name:"MuiDialog",slot:"Root",overridesResolver:(o,s)=>s.root})({"@media print":{position:"absolute !important"}}),Be=w("div",{name:"MuiDialog",slot:"Container",overridesResolver:(o,s)=>{const{ownerState:t}=o;return[s.container,s[`scroll${D(t.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Ie=w(ne,{name:"MuiDialog",slot:"Paper",overridesResolver:(o,s)=>{const{ownerState:t}=o;return[s.paper,s[`scrollPaper${D(t.scroll)}`],s[`paperWidth${D(String(t.maxWidth))}`],t.fullWidth&&s.paperFullWidth,t.fullScreen&&s.paperFullScreen]}})(ie(({theme:o})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:s})=>!s.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:o.breakpoints.unit==="px"?Math.max(o.breakpoints.values.xs,444):`max(${o.breakpoints.values.xs}${o.breakpoints.unit}, 444px)`,[`&.${K.paperScrollBody}`]:{[o.breakpoints.down(Math.max(o.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(o.breakpoints.values).filter(s=>s!=="xs").map(s=>({props:{maxWidth:s},style:{maxWidth:`${o.breakpoints.values[s]}${o.breakpoints.unit}`,[`&.${K.paperScrollBody}`]:{[o.breakpoints.down(o.breakpoints.values[s]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:s})=>s.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:s})=>s.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${K.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ae=r.forwardRef(function(s,t){const n=Y({props:s,name:"MuiDialog"}),l=Ne(),d={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":p,BackdropComponent:c,BackdropProps:f,children:H,className:F,disableEscapeKeyDown:$=!1,fullScreen:v=!1,fullWidth:G=!1,maxWidth:M="sm",onBackdropClick:E,onClick:U,onClose:h,open:u,PaperComponent:W=ne,PaperProps:_={},scroll:B="paper",TransitionComponent:S=De,transitionDuration:T=d,TransitionProps:R,...I}=n,b={...n,disableEscapeKeyDown:$,fullScreen:v,fullWidth:G,maxWidth:M,scroll:B},y=Ee(b),C=r.useRef(),g=x=>{C.current=x.target===x.currentTarget},A=x=>{U&&U(x),C.current&&(C.current=null,E&&E(x),h&&h(x,"backdropClick"))},j=Pe(p),X=r.useMemo(()=>({titleId:j}),[j]);return e.jsx(Ue,{className:k(y.root,F),closeAfterTransition:!0,components:{Backdrop:$e},componentsProps:{backdrop:{transitionDuration:T,as:c,...f}},disableEscapeKeyDown:$,onClose:h,open:u,ref:t,onClick:A,ownerState:b,...I,children:e.jsx(S,{appear:!0,in:u,timeout:T,role:"presentation",...R,children:e.jsx(Be,{className:k(y.container),onMouseDown:g,ownerState:b,children:e.jsx(Ie,{as:W,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":j,..._,className:k(y.paper,_.className),ownerState:b,children:e.jsx(le.Provider,{value:X,children:H})})})})})});function Le(o){return V("MuiDialogActions",o)}O("MuiDialogActions",["root","spacing"]);const Oe=o=>{const{classes:s,disableSpacing:t}=o;return z({root:["root",!t&&"spacing"]},Le,s)},Ve=w("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:t}=o;return[s.root,!t.disableSpacing&&s.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:o})=>!o.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Ye=r.forwardRef(function(s,t){const n=Y({props:s,name:"MuiDialogActions"}),{className:l,disableSpacing:d=!1,...i}=n,p={...n,disableSpacing:d},c=Oe(p);return e.jsx(Ve,{className:k(c.root,l),ownerState:p,ref:t,...i})});function ze(o){return V("MuiDialogContent",o)}O("MuiDialogContent",["root","dividers"]);function He(o){return V("MuiDialogTitle",o)}const Ge=O("MuiDialogTitle",["root"]),Xe=o=>{const{classes:s,dividers:t}=o;return z({root:["root",t&&"dividers"]},ze,s)},qe=w("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:t}=o;return[s.root,t.dividers&&s.dividers]}})(ie(({theme:o})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:s})=>s.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(o.vars||o).palette.divider}`,borderBottom:`1px solid ${(o.vars||o).palette.divider}`}},{props:({ownerState:s})=>!s.dividers,style:{[`.${Ge.root} + &`]:{paddingTop:0}}}]}))),Ke=r.forwardRef(function(s,t){const n=Y({props:s,name:"MuiDialogContent"}),{className:l,dividers:d=!1,...i}=n,p={...n,dividers:d},c=Xe(p);return e.jsx(qe,{className:k(c.root,l),ownerState:p,ref:t,...i})}),Je=o=>{const{classes:s}=o;return z({root:["root"]},He,s)},Qe=w(ke,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(o,s)=>s.root})({padding:"16px 24px",flex:"0 0 auto"}),Ze=r.forwardRef(function(s,t){const n=Y({props:s,name:"MuiDialogTitle"}),{className:l,id:d,...i}=n,p=n,c=Je(p),{titleId:f=d}=r.useContext(le);return e.jsx(Qe,{component:"h2",className:k(c.root,l),ownerState:p,ref:t,variant:"h6",id:d??f,...i})}),{hostname:es}=window.location;let L=fe(es);console.log("ss",L);const rs=()=>{var Z;const{login:o}=ve()||{},[s,t]=r.useState(""),[n,l]=r.useState(!1),[d,i]=r.useState(!1),[p,c]=r.useState(""),[f,H]=r.useState(""),[F,$]=r.useState(!1),[v,G]=r.useState("Normal"),[M,E]=r.useState(!1),[U,h]=r.useState(!1),[u,W]=r.useState("mobile"),[_,B]=r.useState(""),[S,T]=r.useState(""),[R,I]=r.useState("Normal"),[b,y]=r.useState(!1),[C,g]=r.useState(""),[A,j]=r.useState(""),{verifyNumber:X,loginWithPassword:x,storeData:q}=_e(a=>a);let J=be();const ce=()=>{E(!M)},de=a=>{a.preventDefault()},pe=async a=>{a.preventDefault(),F?ge():ue()},ue=async()=>{var a,N;if(v==="false")return i(!0),c("Select a user type");if(!f.trim()){i(!0),c("Please enter your password");return}l(!0),i(!1);try{const m=await x(s,f,L,v);if(console.log("response",m),l(!1),m.error)m.subscription===!1&&J("/upgrade-plan",{state:{userId:m.userId,username:m.username}}),i(!0),c(m.message);else{const xe={username:(a=m.data)==null?void 0:a.username,api_token:(N=m.data)==null?void 0:N.token};o(xe)}}catch{l(!1),i(!0),c("Login failed. Please try again.")}},ge=async()=>{if(v==="false")return i(!0),c("Select a user type");if(!s.trim()||s.length<7){i(!0),c("OTP login requires a valid mobile number");return}l(!0),i(!1);try{let a=await X(s);console.log("otpres",a),a.error?(l(!1),i(!0),c("Enter a valid mobile number")):(l(!1),i(!1),J("/otp",{state:{mobileNumber:s,subdomain:L,registration:!1,userType:v}}))}catch{l(!1),i(!0),c("Failed to send OTP. Please try again.")}},me=async()=>{if(R==="false"){g("Select a user type");return}if(u==="mobile"&&(!_.trim()||_.length<7)){g("Please enter a valid mobile number");return}if(u==="email"&&(!S.trim()||!he(S))){g("Please enter a valid email address");return}y(!0),g(""),j("");try{const N=await we(u==="mobile"?_:S,R,u,L);y(!1),N.error?g(N.message||"Failed to send reset instructions"):(j("Reset instructions sent successfully! Please check your mobile/email."),setTimeout(()=>{h(!1)},2e3))}catch{y(!1),g("Failed to process request. Please try again.")}},he=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),Q=()=>{B(""),T(""),I("Normal"),W("mobile"),g(""),j("")};return e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),e.jsxs("div",{className:"login",children:[e.jsx("div",{className:"login__header",children:`WELCOME TO ${(Z=q==null?void 0:q.storeName)==null?void 0:Z.toUpperCase()}`}),e.jsx("div",{className:"login__header_login",children:"SIGN IN"}),e.jsxs("div",{className:"login__container",children:[e.jsx("div",{className:"login__input_container",children:e.jsx(ee,{value:s,onChange:t,className:"login__phone_input_field",defaultCountry:"in",placeholder:"Enter phone number"})}),e.jsx("div",{className:"login__input_container",children:e.jsx(oe,{fullWidth:!0,children:e.jsxs(te,{id:"user-type",value:v,onChange:a=>G(a.target.value),children:[e.jsx(P,{value:"false",children:"Select User Role"}),e.jsx(P,{value:"Normal",children:"Standard User"}),e.jsx(P,{value:"Dealer",children:"Business Partner"})]})})}),!F&&e.jsx("div",{className:"login__input_container",children:e.jsx(ae,{id:"outlined-password-input",label:"Password",type:M?"text":"password",autoComplete:"current-password",value:f,onChange:a=>H(a.target.value),className:"login__input_field",InputProps:{endAdornment:e.jsx(Me,{position:"end",children:e.jsx(We,{"aria-label":"toggle password visibility",onClick:ce,onMouseDown:de,edge:"end",children:M?e.jsx(Te,{}):e.jsx(Re,{})})})}})}),e.jsxs("div",{className:"login__With_otp_sec",children:[e.jsx("input",{type:"checkbox",onChange:a=>$(a.target.checked)}),"Login With OTP"]}),e.jsx("div",{className:"login__forgot_password",children:e.jsx("button",{type:"button",className:"login__forgot_password_link",onClick:()=>h(!0),children:"Forgot Password?"})}),e.jsx("div",{className:"login__btn_container",children:e.jsx("button",{className:"login__btn",onClick:pe,disabled:n,children:n?e.jsx(re,{size:24}):"SIGN IN"})}),e.jsx("div",{className:"login__redirect_text_sec",children:e.jsxs("div",{className:"login__redirect_text",children:[e.jsx("span",{className:"login__redirect_txt",children:"Don't have an account ?"}),e.jsx(je,{to:"/register",className:"login__redirect_link",children:"SIGN UP"})]})}),d&&e.jsxs("div",{className:"login__error_sec",children:[e.jsx(se,{}),e.jsx("div",{className:"login__error_msg",children:p||"Login Error"})]})]}),e.jsxs(Ae,{open:U,onClose:()=>{h(!1),Q()},maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ze,{children:"Reset Your Password"}),e.jsx(Ke,{children:e.jsxs("div",{className:"login__forgot_password_content",children:[e.jsx("p",{children:"Enter your details to receive reset instructions"}),e.jsxs("div",{className:"login__method_toggle",children:[e.jsx("button",{type:"button",className:`login__method_btn ${u==="mobile"?"active":""}`,onClick:()=>W("mobile"),children:"Mobile"}),e.jsx("button",{type:"button",className:`login__method_btn ${u==="email"?"active":""}`,onClick:()=>W("email"),children:"Email"})]}),u==="mobile"&&e.jsx("div",{className:"login__input_container",children:e.jsx(ee,{value:_,onChange:B,className:"login__phone_input_field",defaultCountry:"in",placeholder:"Enter registered phone number"})}),u==="email"&&e.jsx("div",{className:"login__input_container",children:e.jsx(ae,{fullWidth:!0,label:"Registered Email",type:"email",value:S,onChange:a=>T(a.target.value),placeholder:"Enter your registered email"})}),e.jsx("div",{className:"login__input_container",children:e.jsx(oe,{fullWidth:!0,children:e.jsxs(te,{value:R,onChange:a=>I(a.target.value),children:[e.jsx(P,{value:"false",children:"Select User Role"}),e.jsx(P,{value:"Normal",children:"Standard User"}),e.jsx(P,{value:"Dealer",children:"Business Partner"})]})})}),A&&e.jsx("div",{className:"login__success_sec",children:e.jsx("div",{className:"login__success_msg",children:A})}),C&&e.jsxs("div",{className:"login__error_sec",children:[e.jsx(se,{}),e.jsx("div",{className:"login__error_msg",children:C})]})]})}),e.jsxs(Ye,{children:[e.jsx("button",{onClick:()=>{h(!1),Q()},className:"login__cancel_btn",children:"Cancel"}),e.jsx("button",{onClick:me,disabled:b,className:"login__submit_btn",children:b?e.jsx(re,{size:20}):"Send Reset Instructions"})]})]})]})]})};export{rs as default};
