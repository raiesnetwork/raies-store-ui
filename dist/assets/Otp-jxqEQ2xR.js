import{r as C,u as $,c as A,a as B,d as F,j as n,B as c}from"./index-iqfAz0Kj.js";import{H}from"./Header-n5pZewvg.js";const R=()=>{var d,g,f,h,y,b,v;const[r,j]=C.useState(Array(6).fill("")),{loginUser:N,createUser:_,setUserName:x}=$(s=>s),o=A(),{login:O}=B()||{},p=F(),l=((d=o.state)==null?void 0:d.mobileNumber)||"",u=((g=o.state)==null?void 0:g.subdomain)||"",T=((f=o.state)==null?void 0:f.registration)||!1,P=((h=o.state)==null?void 0:h.username)||"",w=((y=o.state)==null?void 0:y.password)||"",E=((b=o.state)==null?void 0:b.paymentType)||"",m=((v=o.state)==null?void 0:v.userType)||"",U=async()=>{var e,a,i;const s=r.join("");if(s.length===6&&l){let t;if(T)t=await _({fullName:P,mobileNumber:l,otp:s,hostname:u,password:w,userType:m,paymentType:E}),t.error?c.error(t.message||"User registration failed"):(c.success("User registered successfully!"),p("/login"));else if(t=await N(l,s,u,m),t.error)c.error(t.message||"OTP verification failed");else{x((e=t.data)==null?void 0:e.username);const k={username:(a=t.data)==null?void 0:a.username,api_token:(i=t.data)==null?void 0:i.token};O(k),c.success("OTP verified successfully!"),p("/home")}}else c.error("Please enter a valid 6-digit OTP.")},S=(s,e)=>{const a=s.target.value;if(/^[0-9]$/.test(a)||a===""){const i=[...r];if(i[e]=a,j(i),a&&e<r.length-1){const t=document.getElementById(`otp-input-${e+1}`);t&&t.focus()}}};return n.jsxs(n.Fragment,{children:[n.jsx(H,{}),n.jsxs("div",{className:"otp-page",children:[n.jsx("div",{className:"otp-page__header",children:"Enter OTP"}),n.jsx("div",{className:"otp-page__input-container",children:r.map((s,e)=>n.jsx("input",{type:"text",maxLength:1,value:r[e],onChange:a=>S(a,e),id:`otp-input-${e}`,className:"otp-page__input-box"},e||s))}),n.jsx("div",{className:"otp-page__btn-container",children:n.jsx("button",{className:"otp-page__btn",onClick:U,children:"VERIFY"})})]})]})};export{R as default};
