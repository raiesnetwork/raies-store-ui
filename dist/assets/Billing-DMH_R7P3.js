import{y as se,z as te,g as ie,x as re,c as le,r as d,d as oe,j as e,B as j}from"./index-8JYiQdLq.js";import{S as ce,a as de,C as me}from"./city-BO9769IJ.js";/* empty css              */import{S}from"./sweetalert2.esm.all-BkU8I-GU.js";const B={Individuals:[{name:"Free",type:"Free",description:"Best for exploration",price:"14 Days free trail",priceInDollars:"14 Days free trail",amount:"0",dollar:"0",includes:["Community management","Collaboration","User management","Career Development"],plan:"Individuals"},{name:"Individual",type:"Premium",description:"Best for advanced features",price:"₹254/month",priceInDollars:"$2.99/month",amount:"254",dollar:"2.99",includes:["All Free plan features","ASK NEWA","Analytics"],FreeIncludes:["Community management","Collaboration","User management","Career Development"],plan:"Individuals"}],"Consultants/Service providers/Influencers":[{name:"Consultants",plan:"Consultants",type:"Premium",description:"Best for advanced tools",price:"₹849/month",priceInDollars:"$9.99/month",amount:"849",dollar:"9.99",includes:["All Free plan features","Service management","Campaign management","Announcement Desk","ASK NEWA","Analytics"],FreeIncludes:["Community management","Collaboration","User management","Career Development"]}],Businesses:[{name:"Businesses",plan:"Businesses",type:"Premium",description:"Best for scaling teams",price:"₹2,549/month",amount:"2549",dollar:"29.99",priceInDollars:"$29.99/month",includes:["All Services provide by IXES"],FreeIncludes:["Community management","Collaboration","User management","Career Development","E-Store","Service management","Campaign management","Announcement Desk","File Manager","Task Manager","ASK NEWA","Analytics","Financial Management","Administration Tools","Customization (Talk to us for more)"]}]};se();const T=te(),ue=async(c,l)=>{console.log(c,l);try{const{data:m}=await T.post("/storebusiness/create-order",{amount:c,subdomain:l});return console.log(m),m}catch(m){return{error:!0,message:m,data:!1}}},pe=async c=>{try{const{data:l}=await T.post("/storebusiness/couponverify",{code:c,store:!0});return console.log(l),l}catch(l){return{error:!0,message:l,data:!1}}},xe=async(c,l,m,I,g,A,P,D,y,r,w,b,F,n,C,E,f,v,x)=>{try{const{data:s}=await T.post("/storebusiness/verify-payment",{response:c,amount:l,email:m,planDuration:I,address1:g,address2:A,city:P,pin:D,state:y,plan:r,region:w,mobileNumber:b,username:F,userType:n,paymentType:C,password:E,subdomain:v,userId:x,businessPartnerType:f});return s}catch(s){return{error:!0,message:s,data:!1}}},{hostname:he}=window.location;let _=ie(he);const je=()=>{var M,X,q,O,U,W,K;const{id:c}=re(),l=le(),{businessPartnerType:m,mobileNumber:I,username:g,userType:A,paymentType:P,password:D,userId:y}=l.state||{},r=B==null?void 0:B.Businesses,[w,b]=d.useState("");d.useEffect(()=>{c&&b(c),y&&b(y)},[c,y]);const F={email:"",planDuration:"",address1:"",address2:"",city:"",pin:"",state:"",plan:r[0],region:"IN"},[n,C]=d.useState(F),E=me.getAllCountries(),f=n.region?ce.getStatesOfCountry(n.region):[],v=n.state?de.getCitiesOfState(n.region,n.state):[],x=a=>{const{name:t,value:o}=a.target;C(u=>({...u,[t]:o}))},[s,G]=d.useState({}),N=a=>{const{name:t,value:o}=a.target;C(u=>({...u,[t]:o}))},V=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),Y=a=>/^[0-9]{6}$/.test(a),H=()=>{const a={};return(!n.email||!V(n.email))&&(a.email="Invalid email address"),n.planDuration||(a.planDuration="Plan duration is required"),n.address1||(a.address1="Billing address is required"),n.city||(a.city="City is required"),(!n.pin||!Y(n.pin))&&(a.pin="PIN must be exactly 6 digits"),n.state||(a.state="State is required"),G(a),Object.keys(a).length===0},J=oe(),[Q,k]=d.useState(!1),[R,z]=d.useState(0);d.useEffect(()=>{var a,t;if((a=r[0])==null||a.amount,n==null?void 0:n.planDuration){let o=Number((t=r[0])==null?void 0:t.amount)*Number(n==null?void 0:n.planDuration);(n==null?void 0:n.planDuration)==="12"&&(o*=.9),z(Math.round(o))}},[r,n.planDuration]),console.log("plan",r);const Z=async()=>{if(!H())return;const a=R;try{k(!0);const{order:t}=await ue(a,_);console.log(t);const o={key:"rzp_test_WyGXcSo4DyXNsd",amount:t.amount,currency:"INR",name:g,description:"Subscription",order_id:t.id,handler:async i=>{try{const p=await xe(i,a,n.email,n.planDuration,n.address1,n.address2,n.city,n.pin,n.state,n.plan,n.region,I,g,A,P,D,m,_,w);p?(S.fire({icon:"success",title:"Payment successful!",showConfirmButton:!1,timer:3500}),j.success("Sign up Successfully"),J("/login")):S.fire({icon:"error",title:"Payment verification failed",text:p.message}),k(!1)}catch(p){S.fire({icon:"error",title:"Payment verification failed",text:p.message})}},prefill:{name:g,email:n.email,contact:""},theme:{color:"#3399cc"},modal:{ondismiss:()=>{k(!1)}}};new window.Razorpay(o).open()}catch(t){console.error("Payment failed:",t),S.fire({icon:"error",title:"Payment failed",text:"Please try again."})}},[$,ee]=d.useState(""),[ne,L]=d.useState(!1),ae=async()=>{var a,t,o,u;try{if(!$.trim())return j.warning("Enter a valid coupon code");if(!n.planDuration.trim())return j.warning("Select Duration");L(!0);const i=await pe($);if(console.log(i,"ccou"),i!=null&&i.error)j.error(i.message);else{let p=Number((a=r[0])==null?void 0:a.amount)*Number(n==null?void 0:n.planDuration);(n==null?void 0:n.planDuration)==="12"&&(p*=.9);let h=Math.round(p);((t=i==null?void 0:i.coupon)==null?void 0:t.couponType)==="discount-in-percentage"?h=h-h*Number((o=i==null?void 0:i.coupon)==null?void 0:o.discountPercentage)/100:((u=i==null?void 0:i.coupon)==null?void 0:u.couponType)==="discount-amount"&&(h=h-Number(i.coupon.discountAmount)),z(Math.round(h)),j.success(i.message)}}catch{}finally{L(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"billing-modal",children:[e.jsx("style",{children:`.form-control:focus {
  outline: none;
  box-shadow: none;
  border: 1px solid transparent; /* Prevents default browser focus styles */
}`}),e.jsxs("div",{className:"IXES-billing-summary",children:[e.jsx("div",{className:"billing-page-img-sec",children:e.jsx("img",{src:"/media/billingpahe.jpg",alt:"Plan Image",className:"billing-page-image"})}),r?e.jsxs(e.Fragment,{children:[e.jsxs("h2",{children:["Subscribe to ",r[0].type," ",r[0].plan," Plan of ixes"]}),e.jsx("p",{children:r[0].description}),e.jsxs("div",{className:"plan-info",children:[e.jsx("p",{children:e.jsx("div",{className:"IXESPlan-billing-amount",children:(M=r[0])==null?void 0:M.price})}),e.jsx("ul",{className:"IXESPlan-billing-includes",children:((X=r[0])==null?void 0:X.type)==="Premium"&&((q=r[0])!=null&&q.FreeIncludes)?e.jsxs(e.Fragment,{children:[(U=(O=r[0])==null?void 0:O.FreeIncludes)==null?void 0:U.map((a,t)=>e.jsx("li",{children:a},`free-${t}`)),r[0].includes.filter(a=>a!=="All Free plan features").map((a,t)=>e.jsx("li",{children:a},`premium-${t}`))]}):(K=(W=r[0])==null?void 0:W.includes)==null?void 0:K.map((a,t)=>e.jsx("li",{children:a},t))})]})]}):e.jsx("h2",{children:"No plan selected. Please select a plan before subscribing."})]}),e.jsxs("div",{className:"payment-info",children:[e.jsx("h3",{children:"Contact Information"}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("input",{type:"email",name:"email",placeholder:"Email",className:`form-control ${s.email?"is-invalid":""}`,value:n.email,onChange:N}),s.email&&e.jsx("div",{className:"invalid-feedback",children:s.email})]}),e.jsx("h3",{children:"Plan Duration"}),e.jsxs("select",{name:"planDuration",className:`form-control ${s.planDuration?"is-invalid":""}`,value:n.planDuration,onChange:x,children:[e.jsx("option",{value:"",children:"Select Duration"}),e.jsx("option",{value:"1",children:"1 Month"}),e.jsx("option",{value:"12",children:"1 Year (10% Discount)"})]}),s.planDuration&&e.jsx("div",{className:"invalid-feedback",children:s.planDuration}),e.jsx("div",{style:{padding:"8px 0px"},children:e.jsxs("div",{className:"form-control",style:{display:"flex"},children:[e.jsx("input",{type:"text",style:{border:"1px solid transparent",borderRadius:"4px",padding:"8px",width:"100%",outline:"none"},placeholder:"Apply coupon",className:"form-control",value:$,onChange:a=>ee(a.target.value)}),e.jsx("button",{disabled:ne,onClick:ae,className:"btn btn-primary",children:"Apply"})]})}),e.jsx("div",{style:{padding:"8px 0px"},children:e.jsx("input",{type:"text",readOnly:!0,placeholder:"Total amount",className:"form-control",value:`Total Amount: ₹${R}`})}),e.jsxs("div",{style:{padding:"8px 0px"},className:"billing-address",children:[e.jsx("h3",{children:"billing-address"}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("label",{htmlFor:"",children:"Country"}),e.jsxs("select",{onChange:x,name:"region",value:n.region,className:`form-control ${s.region?"is-invalid":""}`,children:[e.jsx("option",{value:"",children:"Select Country"}),E.map(a=>e.jsx("option",{value:a.isoCode,children:a.name},a.isoCode))]})]}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("label",{htmlFor:"",children:"State"}),e.jsxs("select",{onChange:x,name:"state",value:n.state,className:`form-control ${s.state?"is-invalid":""}`,children:[e.jsx("option",{value:"",children:"Select State"}),f==null?void 0:f.map(a=>e.jsx("option",{value:a.isoCode,children:a.name},a.isoCode))]}),s.state&&e.jsx("div",{className:"invalid-feedback",children:s.state})]}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("label",{htmlFor:"",children:"City"}),e.jsxs("select",{onChange:x,name:"city",value:n.city,className:`form-control ${s.city?"is-invalid":""}`,children:[e.jsx("option",{value:"",children:"Select City"}),v==null?void 0:v.map(a=>e.jsx("option",{value:a.name,children:a.name},a.stateCode))]}),s.city&&e.jsx("div",{className:"invalid-feedback",children:s.city})]}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("input",{type:"text",name:"address1",placeholder:" Address Line 1",className:`form-control ${s.address1?"is-invalid":""}`,value:n.address1,onChange:N}),s.address1&&e.jsx("div",{className:"invalid-feedback",children:s.address1})]}),e.jsx("div",{style:{padding:"8px 0px"},children:e.jsx("input",{type:"text",name:"address2",placeholder:"Address Line 2",value:n.address2,onChange:N,className:"form-control"})}),e.jsxs("div",{style:{padding:"8px 0px"},children:[e.jsx("input",{type:"number",name:"pin",placeholder:"PIN",className:`form-control ${s.pin?"is-invalid":""}`,value:n.pin,onChange:N,maxLength:6,max:6,min:6,minLength:6}),s.pin&&e.jsx("div",{className:"invalid-feedback",children:s.pin})]})]}),e.jsx("div",{className:"checkbox-section"}),e.jsx("button",{disabled:Q,className:"btn btn-primary  w-100",onClick:Z,children:"Subscribe"})]})]})})};export{je as default};
